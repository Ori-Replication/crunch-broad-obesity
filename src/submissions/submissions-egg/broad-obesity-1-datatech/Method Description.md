# Method Description

The approach employs a Variational Autoencoder (VAE) to learn a compressed, low-dimensional latent representation of the single-cell gene expression data. 

During training, the VAE is optimized to reconstruct input gene profiles while learning the distribution of cellular states. 

After training, latent vectors for all cells are extracted, and the mean latent shift between control (NC) and perturbed cells is calculated. 

A Ridge regression model is then trained to predict cell program proportions (pre_adipo, adipo, lipo, other) directly from the mean latent representations of genes found in the training set. 

For inference on unknown perturbations, synthetic latent vectors are generated by applying the calculated average perturbation shift to the control mean and adding Gaussian noise derived from control variability. 

These synthetic latent vectors are decoded by the VAE to generate the predicted gene expression matrix, and the trained regression model estimates the final program proportions for these new states.


# Rationale

The VAE is utilized to effectively denoise high-dimensional single-cell data and capture the underlying biological manifold in a robust latent space. 

Operating in this latent space simplifies the relationship between gene perturbations and cellular phenotypes, making it easier to model than raw expression counts. 

Ridge regression was chosen for the proportion predictor to handle potential multicollinearity in the latent features and to prevent overfitting given the limited number of training examples. 

The assumption that unknown perturbations follow the "average shift" observed in the training data allows for a generalized generation strategy when specific perturbation effects are not known. 

Adding noise during generation ensures that the predicted proportions reflect biological heterogeneity rather than a single deterministic outcome.


# Data and Resources Used

The primary dataset `obesity_challenge_1.h5ad` was used to train the VAE model and extract latent statistical features. 

The file `program_proportion.csv` provided the ground truth labels required to train the Ridge regression model for proportion estimation. 

The list of genes to predict and the specific perturbations for the inference phase were sourced from `genes_to_predict.txt` and `predict_perturbations.txt` respectively. 

Model artifacts, including the VAE weights (`vae_model.pth`), latent statistics (`latent_stats.npy`), and the trained regression model (`prop_model.pkl`), were saved during training and loaded for inference. 

Computational resources were managed using PyTorch for deep learning operations and Scanpy for handling AnnData objects efficiently in backed mode.