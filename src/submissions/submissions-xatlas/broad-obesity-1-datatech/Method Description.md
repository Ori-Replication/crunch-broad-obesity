# Method Description

This method employs PCA-level transfer learning from the xatlas external perturbation dataset (HEK293T cell line) to predict gene perturbation effects in the competition's adipocyte precursor cells.

## Core Approach: PCA Transfer (PCA_HEK_pc5_alpha100)

1. **Training delta computation**: For each of the 122 training perturbations, compute the mean expression delta (perturbed - control) across all cells.

2. **Competition PCA**: Apply PCA with 5 components to the 122 training deltas, capturing the major axes of perturbation variation.

3. **xatlas feature extraction**: Aggregate perturbation deltas from 223 HEK293T batches in the xatlas dataset. Apply PCA (30 components) to the xatlas deltas for the training perturbations.

4. **Ridge regression transfer**: Train a Ridge regression (alpha=100) mapping from xatlas PCA features to competition PCA scores. This captures conserved perturbation patterns across cell types at the latent space level.

5. **Prediction**: For each of the 2863 target perturbations, project its xatlas delta through the xatlas PCA, predict competition PCA scores via Ridge regression, and reconstruct the competition delta. For perturbations absent from xatlas (53 out of 2863), fall back to the average training delta (PerturbMean).

6. **Cell generation**: Sample 100 NC (control) cells with mean-matching, then add the predicted delta to generate perturbed cell profiles.

## Rationale

Direct transfer of perturbation deltas between different cell types shows negligible correlation due to cell-type-specific responses. However, PCA-level transfer captures shared latent biological pathway structures that are partially conserved across cell types. By operating in a low-dimensional PCA space and using Ridge regression with strong regularization, the model avoids overfitting while extracting transferable signals.

In cross-validation experiments, this method achieved Pearson correlation of 0.2259 compared to 0.2215 for PerturbMean baseline (+2.0%).

## Data and Resources Used

- **Competition data**: `obesity_challenge_1.h5ad` for training delta computation and NC cell sampling.
- **External data**: xatlas HEK293T whole-genome perturbation dataset (223 batches, ~13,000 perturbations per batch, 16,259 overlapping genes).
- **Pre-computed**: `prediction_table_fp16_compressed.h5ad` contains the predicted mean expression profile for all 2863 target perturbations, generated by `prepare_resources.py`.
- **Program proportions**: Average proportions from `program_proportion.csv`.
